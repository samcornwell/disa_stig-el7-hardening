#
# Generated by Chef for <%= node['fqdn'] %>.
# Local modifications will be overwritten.
#
# sample configuration for iptables service
# you can edit this manually or use system-config-firewall
# please do not ask us to add additional ports/services to this default configuration
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
# Rate limiting rules:
# Set rates with burst for new conns, then log/drop the excess
#  V-72271: The operating system must protect against or limit the effects of Denial of
#  Service (DoS) attacks
-A INPUT -p tcp --syn -m limit --limit 4/s --limit-burst 10 -j ACCEPT
-A INPUT -p tcp --syn -j LOG
-A INPUT -p tcp --syn -j DROP
-A INPUT -p udp -m state --state NEW -m limit --limit 1/s --limit-burst 5 -j ACCEPT
-A INPUT -p udp -m state --state NEW -j LOG
-A INPUT -p udp -m state --state NEW -j DROP
-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
-A INPUT -p icmp --icmp-type 8 -m limit --limit 1/s  --limit-burst 5  -j ACCEPT
-A INPUT -p icmp --icmp-type 11 -m limit --limit 1/s --limit-burst 5  -j ACCEPT
-A INPUT -j REJECT --reject-with icmp-host-prohibited
-A FORWARD -j REJECT --reject-with icmp-host-prohibited
COMMIT
